<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="3u3GJBS4sV_i84DYD3jwVja_4TgZYRfWzM-tpkvGB4E">



  <meta name="msvalidate.01" content="3342BDBCF6E2BADB49913694CACAD853">


















<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.5.0" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=6.5.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=6.5.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=6.5.0">


  <link rel="mask-icon" href="/images/favicon.ico?v=6.5.0" color="#222">









<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.5.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="å‰è¨€Deno å·²ç»æ­£å¼å‘å¸ƒäº†ğŸ‰ï¼å®˜ç½‘åœ°å€ æˆ‘è¯´è¿™å¥è¯æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¤šå‰ç«¯ å’Œ NodeJS å·¥ï¼ˆç ï¼‰ç¨‹ï¼ˆå†œï¼‰å¸ˆå·²ç»æŒ‰ä¸ä½è‡ªå·±çš„40ç±³å¤§åˆ€äº†ã€‚å¿ƒä¸­çš„ä¸ä»…æ„Ÿæ…¨å‰ç«¯æ˜¯çœŸçš„ä¼šé€ è½®å­ï¼Œæœ‰äº† node è¿˜ä¸å¤Ÿå—ï¼Œè¿˜æ²¡å­¦ä¼š node åˆæäº†ä¸ª denoï¼Œnode å’Œ deno å•¥åŒºåˆ«ï¼Ÿï¼ çš„ç¡®ï¼Œdeno å’Œ node å½¢æ€å¾ˆç›¸ä¼¼ï¼Œè¦è§£å†³çš„é—®é¢˜ä¼¼ä¹ä¹Ÿç›¸åŒï¼Œé‚£ä»–ä»¬åˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Œè¿™ä¸€åˆ‡ç©¶ç«Ÿæ˜¯é“å¾·çš„æ²¦ä¸§è¿˜æ˜¯ ry ï¼ˆ">
<meta name="keywords" content="è½¬è½½">
<meta property="og:type" content="article">
<meta property="og:title" content="Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«">
<meta property="og:url" content="https://xiuminglee.cn/è½¬è½½/Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«.html">
<meta property="og:site_name" content="Xiuming Lee">
<meta property="og:description" content="å‰è¨€Deno å·²ç»æ­£å¼å‘å¸ƒäº†ğŸ‰ï¼å®˜ç½‘åœ°å€ æˆ‘è¯´è¿™å¥è¯æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¤šå‰ç«¯ å’Œ NodeJS å·¥ï¼ˆç ï¼‰ç¨‹ï¼ˆå†œï¼‰å¸ˆå·²ç»æŒ‰ä¸ä½è‡ªå·±çš„40ç±³å¤§åˆ€äº†ã€‚å¿ƒä¸­çš„ä¸ä»…æ„Ÿæ…¨å‰ç«¯æ˜¯çœŸçš„ä¼šé€ è½®å­ï¼Œæœ‰äº† node è¿˜ä¸å¤Ÿå—ï¼Œè¿˜æ²¡å­¦ä¼š node åˆæäº†ä¸ª denoï¼Œnode å’Œ deno å•¥åŒºåˆ«ï¼Ÿï¼ çš„ç¡®ï¼Œdeno å’Œ node å½¢æ€å¾ˆç›¸ä¼¼ï¼Œè¦è§£å†³çš„é—®é¢˜ä¼¼ä¹ä¹Ÿç›¸åŒï¼Œé‚£ä»–ä»¬åˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Œè¿™ä¸€åˆ‡ç©¶ç«Ÿæ˜¯é“å¾·çš„æ²¦ä¸§è¿˜æ˜¯ ry ï¼ˆ">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2020-05-14T07:58:24.343Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«">
<meta name="twitter:description" content="å‰è¨€Deno å·²ç»æ­£å¼å‘å¸ƒäº†ğŸ‰ï¼å®˜ç½‘åœ°å€ æˆ‘è¯´è¿™å¥è¯æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¤šå‰ç«¯ å’Œ NodeJS å·¥ï¼ˆç ï¼‰ç¨‹ï¼ˆå†œï¼‰å¸ˆå·²ç»æŒ‰ä¸ä½è‡ªå·±çš„40ç±³å¤§åˆ€äº†ã€‚å¿ƒä¸­çš„ä¸ä»…æ„Ÿæ…¨å‰ç«¯æ˜¯çœŸçš„ä¼šé€ è½®å­ï¼Œæœ‰äº† node è¿˜ä¸å¤Ÿå—ï¼Œè¿˜æ²¡å­¦ä¼š node åˆæäº†ä¸ª denoï¼Œnode å’Œ deno å•¥åŒºåˆ«ï¼Ÿï¼ çš„ç¡®ï¼Œdeno å’Œ node å½¢æ€å¾ˆç›¸ä¼¼ï¼Œè¦è§£å†³çš„é—®é¢˜ä¼¼ä¹ä¹Ÿç›¸åŒï¼Œé‚£ä»–ä»¬åˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Œè¿™ä¸€åˆ‡ç©¶ç«Ÿæ˜¯é“å¾·çš„æ²¦ä¸§è¿˜æ˜¯ ry ï¼ˆ">






  <link rel="canonical" href="https://xiuminglee.cn/è½¬è½½/Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«.html">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ« | Xiuming Lee-ä¸ªäººæŠ€æœ¯åšå®¢ï¼å…¨æ ˆå·¥ç¨‹å¸ˆ|Java|JavaScript|å¾®æœåŠ¡|å¤§æ•°æ®|äººå·¥æ™ºèƒ½|äº‘è®¡ç®—</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?58ee8d001c80d3a9f364ce1ba5695c65";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>






  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Xiuming Lee</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <h1 class="site-subtitle" itemprop="description">Programing is an art from</h1>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>é¦–é¡µ</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>æ ‡ç­¾</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>åˆ†ç±»</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>å½’æ¡£</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>æœç´¢</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="æœç´¢..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://xiuminglee.cn/è½¬è½½/Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Xiuming Lee">
      <meta itemprop="description" content="Think Twice Code Oncecd">
      <meta itemprop="image" content="http://qiniu.mrain22.cn/image/touxiang/201811291022.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Xiuming Lee">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">Denoæ­£å¼å‘å¸ƒï¼Œå½»åº•å¼„æ˜ç™½å’ŒNodeçš„åŒºåˆ«
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">å‘è¡¨äº</span>
              

              
                
              

              <time title="åˆ›å»ºæ—¶é—´ï¼š2020-05-14 15:35:43 / ä¿®æ”¹æ—¶é—´ï¼š15:58:24" itemprop="dateCreated datePublished" datetime="2020-05-14T15:35:43+08:00">2020-05-14</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">åˆ†ç±»äº</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/è½¬è½½/" itemprop="url" rel="index"><span itemprop="name">è½¬è½½</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="post-meta-item-icon">
            <i class="fa fa-eye"></i>
             é˜…è¯»æ¬¡æ•°ï¼š 
            <span class="busuanzi-value" id="busuanzi_value_page_pv"></span>
            </span>
          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>Deno å·²ç»æ­£å¼å‘å¸ƒäº†ğŸ‰ï¼<a href="https://deno.land/" target="_blank" rel="noopener">å®˜ç½‘åœ°å€</a></p>
<p>æˆ‘è¯´è¿™å¥è¯æ—¶å€™ï¼Œæ˜¯ä¸æ˜¯å¾ˆå¤šå‰ç«¯ å’Œ NodeJS å·¥ï¼ˆç ï¼‰ç¨‹ï¼ˆå†œï¼‰å¸ˆå·²ç»æŒ‰ä¸ä½è‡ªå·±çš„40ç±³å¤§åˆ€äº†ã€‚å¿ƒä¸­çš„ä¸ä»…æ„Ÿæ…¨å‰ç«¯æ˜¯çœŸçš„ä¼šé€ è½®å­ï¼Œæœ‰äº† node è¿˜ä¸å¤Ÿå—ï¼Œè¿˜æ²¡å­¦ä¼š node åˆæäº†ä¸ª denoï¼Œnode å’Œ deno å•¥åŒºåˆ«ï¼Ÿï¼</p>
<p>çš„ç¡®ï¼Œdeno å’Œ node å½¢æ€å¾ˆç›¸ä¼¼ï¼Œè¦è§£å†³çš„é—®é¢˜ä¼¼ä¹ä¹Ÿç›¸åŒï¼Œé‚£ä»–ä»¬åˆ°åº•æœ‰å•¥åŒºåˆ«ï¼Œè¿™ä¸€åˆ‡ç©¶ç«Ÿæ˜¯é“å¾·çš„æ²¦ä¸§è¿˜æ˜¯ ry ï¼ˆä½œè€…ï¼‰äººæ€§çš„æ‰­æ›²ï¼Œè®©æˆ‘ä»¬èµ°è¿›æœ¬ç¯‡æ–‡ç« ï¼Œä¸€æ¢ç©¶ç«Ÿã€‚</p>
<h2 id="Deno-VS-Node"><a href="#Deno-VS-Node" class="headerlink" title="Deno VS Node"></a>Deno VS Node</h2><table>
<thead>
<tr>
<th></th>
<th>Node</th>
<th>Deno</th>
</tr>
</thead>
<tbody>
<tr>
<td>API å¼•ç”¨æ–¹å¼</td>
<td>æ¨¡å—å¯¼å…¥</td>
<td>å…¨å±€å¯¹è±¡</td>
</tr>
<tr>
<td>æ¨¡å—ç³»ç»Ÿ</td>
<td>CommonJS &amp; æ–°ç‰ˆ node å®éªŒæ€§ ES Module</td>
<td>ES Module æµè§ˆå™¨å®ç°</td>
</tr>
<tr>
<td>å®‰å…¨</td>
<td>æ— å®‰å…¨é™åˆ¶</td>
<td>é»˜è®¤å®‰å…¨</td>
</tr>
<tr>
<td>Typescript</td>
<td>ç¬¬ä¸‰æ–¹ï¼Œå¦‚é€šè¿‡ ts-node æ”¯æŒ</td>
<td>åŸç”Ÿæ”¯æŒ</td>
</tr>
<tr>
<td>åŒ…ç®¡ç†</td>
<td>npm + node_modules</td>
<td>åŸç”Ÿæ”¯æŒ</td>
</tr>
<tr>
<td>å¼‚æ­¥æ“ä½œ</td>
<td>å›è°ƒ</td>
<td>Promise</td>
</tr>
<tr>
<td>åŒ…åˆ†å‘</td>
<td>ä¸­å¿ƒåŒ– npmjs.com</td>
<td>å»ä¸­å¿ƒåŒ– import url</td>
</tr>
<tr>
<td>å…¥å£</td>
<td>package.json é…ç½®</td>
<td>import url ç›´æ¥å¼•å…¥</td>
</tr>
<tr>
<td>æ‰“åŒ…ã€æµ‹è¯•ã€æ ¼å¼åŒ–</td>
<td>ç¬¬ä¸‰æ–¹å¦‚ eslintã€gulpã€webpackã€babel ç­‰</td>
<td>åŸç”Ÿæ”¯æŒ</td>
</tr>
</tbody>
</table>
<h3 id="1-å†…ç½®-API-å¼•ç”¨æ–¹å¼ä¸åŒ"><a href="#1-å†…ç½®-API-å¼•ç”¨æ–¹å¼ä¸åŒ" class="headerlink" title="1.å†…ç½® API å¼•ç”¨æ–¹å¼ä¸åŒ"></a>1.å†…ç½® API å¼•ç”¨æ–¹å¼ä¸åŒ</h3><h4 id="node-æ¨¡å—å¯¼å…¥"><a href="#node-æ¨¡å—å¯¼å…¥" class="headerlink" title="node æ¨¡å—å¯¼å…¥"></a>node æ¨¡å—å¯¼å…¥</h4><p>node å†…ç½® API é€šè¿‡æ¨¡å—å¯¼å…¥çš„æ–¹å¼å¼•ç”¨ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line">fs.readFileSync(<span class="string">"./data.txt"</span>);</span><br></pre></td></tr></table></figure>
<h4 id="deno-å…¨å±€å¯¹è±¡"><a href="#deno-å…¨å±€å¯¹è±¡" class="headerlink" title="deno å…¨å±€å¯¹è±¡"></a>deno å…¨å±€å¯¹è±¡</h4><p>è€Œ deno åˆ™æ˜¯ä¸€ä¸ªå…¨å±€å¯¹è±¡ <code>Deno</code> çš„å±æ€§å’Œæ–¹æ³•ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Deno.readFileSync(<span class="string">"./data.txt"</span>);</span><br></pre></td></tr></table></figure>
<p>å…·ä½“ deno æœ‰å“ªäº›æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>repl</code> çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">deno # æˆ– deno repl</span><br></pre></td></tr></table></figure>
<p>è¿›å…¥ <code>repl</code> åï¼Œè¾“å…¥ <code>Deno</code> å›è½¦ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line"> Buffer: [Function: Buffer],</span><br><span class="line"> readAll: [AsyncFunction: readAll],</span><br><span class="line"> readAllSync: [Function: readAllSync],</span><br><span class="line"> writeAll: [AsyncFunction: writeAll],</span><br><span class="line"> writeAllSync: [Function: writeAllSync],</span><br><span class="line"><span class="meta"> #</span> .....</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ç§å¤„ç†çš„æ–¹å¼å¥½å¤„æ˜¯ç®€å•ã€æ–¹ä¾¿ï¼Œåå¤„æ˜¯æ²¡æœ‰åˆ†ç±»ï¼Œæƒ³æŸ¥æ‰¾å¿˜è®°çš„ API æ¯”è¾ƒå›°éš¾ã€‚æ€»ä½“æ¥è¯´è§ä»è§æ™ºã€‚</p>
<h3 id="2-æ¨¡å—ç³»ç»Ÿ"><a href="#2-æ¨¡å—ç³»ç»Ÿ" class="headerlink" title="2.æ¨¡å—ç³»ç»Ÿ"></a>2.æ¨¡å—ç³»ç»Ÿ</h3><p>æˆ‘ä»¬å†æ¥çœ‹ä¸€ä¸‹æ¨¡å—ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯ deno å’Œ node å·®åˆ«æœ€å¤§çš„åœ°æ–¹ï¼ŒåŒæ ·ä¹Ÿæ˜¯ deno å’Œ node ä¸å…¼å®¹çš„åœ°æ–¹ã€‚</p>
<h4 id="node-CommonJS-è§„èŒƒ"><a href="#node-CommonJS-è§„èŒƒ" class="headerlink" title="node CommonJS è§„èŒƒ"></a>node CommonJS è§„èŒƒ</h4><p>æˆ‘ä»¬éƒ½çŸ¥é“ node é‡‡ç”¨çš„æ˜¯ <a href="https://javascript.ruanyifeng.com/nodejs/module.html" target="_blank" rel="noopener">CommonJS</a> è§„èŒƒï¼Œè€Œ deno åˆ™æ˜¯é‡‡ç”¨çš„ ES Module çš„æµè§ˆå™¨å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬é¦–å…ˆæ¥è®¤è¯†ä¸€ä¸‹ï¼š</p>
<h4 id="ES-Module-çš„æµè§ˆå™¨å®ç°"><a href="#ES-Module-çš„æµè§ˆå™¨å®ç°" class="headerlink" title="ES Module çš„æµè§ˆå™¨å®ç°"></a>ES Module çš„æµè§ˆå™¨å®ç°</h4><p>è€Œ deno åˆ™é‡‡ç”¨ <strong>ES Module çš„æµè§ˆå™¨å®ç°</strong>ï¼Œå…·ä½“å…³äº <a href="https://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener">ES Module</a> æƒ³å¿…å¤§å®¶éƒ½æ—©å·²ç†ŸçŸ¥ï¼Œä½†å…¶æµè§ˆå™¨å®ç°å¯èƒ½å¤§å®¶è¿˜ä¸æ˜¯å¾ˆç†Ÿæ‚‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸‹å…¶æµè§ˆå™¨å®ç°ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- æ³¨æ„è¿™é‡Œä¸€å®šè¦åŠ ä¸Š type="module" --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"module"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// ä» URL å¯¼å…¥</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">"https://unpkg.com/vue@2.6.11/dist/vue.esm.browser.js"</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// ä»ç›¸å¯¹è·¯å¾„å¯¼å…¥</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> * <span class="keyword">as</span> utils <span class="keyword">from</span> <span class="string">"./utils.js"</span>;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// ä»ç»å¯¹è·¯å¾„å¯¼å…¥</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> <span class="string">"/index.js"</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="comment">// ä¸æ”¯æŒ</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">"foo.js"</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> bar <span class="keyword">from</span> <span class="string">"bar/index.js"</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">import</span> zoo <span class="keyword">from</span> <span class="string">"./index"</span>; <span class="comment">// æ²¡æœ‰ .js åç¼€</span></span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="deno-çš„æ¨¡å—è§„èŒƒ"><a href="#deno-çš„æ¨¡å—è§„èŒƒ" class="headerlink" title="deno çš„æ¨¡å—è§„èŒƒ"></a>deno çš„æ¨¡å—è§„èŒƒ</h4><p>deno å®Œå…¨éµå¾ª es module æµè§ˆå™¨å®ç°ï¼Œdeno ä¹Ÿæ˜¯å¦‚æ­¤ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æ”¯æŒ</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">"https://deno.land/std/fs/mod.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; deepCopy &#125; <span class="keyword">from</span> <span class="string">"./deepCopy.js"</span>;</span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">"/foo.ts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸æ”¯æŒ</span></span><br><span class="line"><span class="keyword">import</span> foo <span class="keyword">from</span> <span class="string">"foo.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> bar <span class="keyword">from</span> <span class="string">"./bar"</span>; <span class="comment">// å¿…é¡»æŒ‡å®šæ‰©å±•å</span></span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å‘ç°å…¶å’Œæˆ‘ä»¬å¹³å¸¸åœ¨ webpack æˆ–è€… ts ä½¿ç”¨ es module æœ€å¤§çš„<strong>ä¸åŒ</strong>ï¼š</p>
<ul>
<li>å¯ä»¥é€šè¿‡ import url ç›´æ¥å¼•ç”¨çº¿ä¸Šèµ„æºï¼›</li>
<li>èµ„æºä¸å¯çœç•¥æ‰©å±•åå’Œæ–‡ä»¶åã€‚</li>
</ul>
<p>å…³äºç¬¬ 1 ç‚¹ï¼Œäº‰è®®éå¸¸å¤§ï¼Œæœ‰äººå¾ˆçœ‹å¥½ï¼Œè§‰å¾—æå¤§çš„æ‰©å±•äº† deno åº“çš„èŒƒå›´ï¼›æœ‰äººåˆ™ä¸å¤ªçœ‹å¥½ï¼Œè§‰å¾—å›½å†…ç½‘é€Ÿçš„åŸå› ï¼Œå¹¶ä¸å®ç”¨ã€‚å¤§å®¶çš„çœ‹æ³•å¦‚ä½•ï¼Œæ¬¢è¿åœ¨è¯„è®ºåŒºå‘è¡¨ ğŸ¤”</p>
<h3 id="3-å®‰å…¨"><a href="#3-å®‰å…¨" class="headerlink" title="3.å®‰å…¨"></a>3.å®‰å…¨</h3><p>å¦‚æœæ¨¡å—è§„èŒƒæ˜¯ node å’Œ deno æœ€å¤§çš„ä¸åŒï¼Œé‚£ä¹ˆå¯¹å®‰å…¨çš„å¤„ç†ï¼Œåˆ™æ˜¯å¦å¤–ä¸€ä¸ªè®©äººæ‘¸ä¸ç€å¤´è„‘çš„åœ°æ–¹ã€‚</p>
<h4 id="æ¨¡æ‹Ÿç›—å·"><a href="#æ¨¡æ‹Ÿç›—å·" class="headerlink" title="æ¨¡æ‹Ÿç›—å·"></a>æ¨¡æ‹Ÿç›—å·</h4><p>åœ¨ä»‹ç»ä¹‹å‰æˆ‘ä»¬å…ˆæ€è€ƒä¸€ä¸‹è¿™ä¸ªåœºæ™¯ä¼šä¸ä¼šå‡ºç°ï¼š</p>
<p>æˆ‘åšäº†ä¸€ä¸ªåŸºäºå‘½ä»¤è¡Œçš„ä¸€é”®ä¸Šç½‘å·¥å…· <code>breakwall</code>ï¼Œæ¯æœˆ 1 ä¸ª G å…è´¹æµé‡ï¼Œç„¶åå°†å‹ç¼©åçš„ JS ä»£ç å‘å¸ƒåˆ° npm ä¸Šï¼Œç„¶åååœ¨å„ç§æ¸ é“å®£ä¼ ä¸€æ³¢ã€‚</p>
<p>ç¾Šæ¯›å…šå…´é«˜å½©çƒˆçš„ <code>cnpm install -g breakwall</code>ï¼Œç„¶åæ¯æ¬¡ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘å·å·çš„å°†è¯¸ä½çš„ ssh å¯†é’¥å’Œå„ç§èƒ½å·çš„æ–‡æ¡£åŠå›¾ç‰‡å·å·ä¸Šä¼ åˆ°æˆ‘çš„æœåŠ¡å™¨ï¼Œåœ¨è®¾å®šæœŸé™åˆ°æœŸåï¼Œåˆ é™¤ç”µè„‘ä¸Šèµ„æ–™ï¼Œç•™ä¸‹ä¸€å¥æ‹¿é’±æ¢èµ„æ–™ï¼Œä»…æ”¯æŒæ¯”ç‰¹å¸ã€‚</p>
<h4 id="é»˜è®¤å®‰å…¨çš„-deno"><a href="#é»˜è®¤å®‰å…¨çš„-deno" class="headerlink" title="é»˜è®¤å®‰å…¨çš„ deno"></a>é»˜è®¤å®‰å…¨çš„ deno</h4><p>å¦‚æœä½ è§‰å¾—ä»¥ä¸Šæƒ…å†µæœ‰å¯èƒ½å‡ºç°ï¼Œåˆ™ä¼šè§‰å¾—ä¸‹é¢çš„åŠŸèƒ½å¾ˆå®ç”¨ã€‚æˆ‘ä»¬å…ˆç”¨ deno æ‰§è¡Œä»¥ä¸‹ä»£ç ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">let</span> rsa = Deno.readFileSync(Deno.dir(<span class="string">"home"</span>) + <span class="string">"/.ssh/id_rsa"</span>);</span><br><span class="line"></span><br><span class="line">rsa = <span class="keyword">new</span> TextDecoder().decode(rsa);</span><br><span class="line"></span><br><span class="line">fetch(<span class="string">"http://jsonplaceholder.typicode.com/posts/1"</span>, &#123;</span><br><span class="line">  method: <span class="string">"POST"</span>,</span><br><span class="line">  body: <span class="built_in">JSON</span>.stringify(rsa)</span><br><span class="line">&#125;)</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> res.json())</span><br><span class="line">  .then(<span class="function">(<span class="params">res</span>) =&gt;</span> <span class="built_in">console</span>.log(<span class="string">"å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ"</span>));</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"start breakwall..."</span>);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>PS:<code>--unstable</code> æ˜¯ç”±äº<code>Deno.dir</code> API ä¸ç¨³å®š</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --unstable index.js</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å°†ä¼šå¾—åˆ°å¦‚ä¸‹æŠ¥é”™ä¿¡æ¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --unstable  index.js</span><br><span class="line">error: Uncaught PermissionDenied: access to environment variables, run again with the --allow-env flag</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>æ„æ€å°±æ˜¯æƒé™å¼‚å¸¸ï¼Œéœ€è¦è®¿é—®ç¯å¢ƒå˜é‡ï¼Œéœ€è¦åŠ ä¸Š <code>--allow-env</code>ï¼Œæˆ‘ä»¬åŠ ä¸Šè¿™ä¸ªå‚æ•°å†è¯•ä¸€ä¸‹ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --unstable --allow-env index.js</span><br><span class="line">error: Uncaught PermissionDenied: read access to "/Users/Xiuming/.ssh/id_rsa", run again with the --allow-read flag</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
<p>å¦‚æ­¤åå¤ï¼Œè¿˜éœ€åŠ ä¸Š <code>--allow-read</code>ã€<code>--allow-net</code> ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --unstable --allow-env --allow-read --allow-net  index.js</span><br><span class="line">start breakwall...</span><br><span class="line">å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ</span><br></pre></td></tr></table></figure>
<p>ç»è¿‡ä¸€ç•ªæŠ˜è…¾ï¼Œæ€»ç®—æ˜¯å‘é€æˆåŠŸäº†ï¼Œè¦æƒ³ç›—å–å¯†é’¥å®å±ä¸æ˜“ã€‚</p>
<h4 id="ç™½åå•"><a href="#ç™½åå•" class="headerlink" title="ç™½åå•"></a>ç™½åå•</h4><p>é‚£æœ‰äººå°±è¯´äº†ï¼Œå¦‚æœæˆ‘çš„åº”ç”¨ç¡®å®éœ€è¦è®¿é—®ç½‘ç»œå’Œæ–‡ä»¶ï¼Œä½†æ˜¯æœ‰ä¸æƒ³è®©å®ƒè®¿é—® .ssh æ–‡ä»¶æœ‰æ²¡æœ‰åŠæ³•ï¼Ÿ</p>
<p>å½“ç„¶æœ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥ç»™ <code>--allow-read</code> å’Œ <code>--allow-net</code> æŒ‡å®šç™½åå•ï¼Œåå•ä¹‹å¤–éƒ½ä¸å¯è®¿é—®ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --unstable --allow-env --allow-read --allow-net=https://www.baidu.com  index.js</span><br><span class="line">start breakwall...</span><br><span class="line">error: Uncaught PermissionDenied: network access to "http://jsonplaceholder.typicode.com/posts/1", run again with the --allow-net flag</span><br><span class="line">    at unwrapResponse ($deno$/ops/dispatch_json.ts:43:11)</span><br><span class="line">    at Object.sendAsync ($deno$/ops/dispatch_json.ts:98:10)</span><br><span class="line">    at async fetch ($deno$/web/fetch.ts:591:27)</span><br></pre></td></tr></table></figure>
<h4 id="ç®€åŒ–å‚æ•°"><a href="#ç®€åŒ–å‚æ•°" class="headerlink" title="ç®€åŒ–å‚æ•°"></a>ç®€åŒ–å‚æ•°</h4><p>å¦‚æœç¡®è®¤æ˜¯æ²¡é—®é¢˜ï¼Œæˆ–è€…æ˜¯è‡ªå·±å¼€å‘è½¯ä»¶æ—¶ï¼Œå›¾ä¸ªæ–¹ä¾¿ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ <code>-A</code> æˆ– <code>--allow-all</code> å‚æ•°å…è®¸æ‰€æœ‰æƒé™ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno -A --unstable index.js</span><br><span class="line">start breakwall...</span><br><span class="line">å¯†é’¥å‘é€æˆåŠŸï¼Œå˜¿å˜¿å˜¿ğŸ˜œ</span><br></pre></td></tr></table></figure>
<p>å®‰å…¨è¿™æ–¹é¢è§ä»è§æ™ºï¼Œæœ‰äººè§‰å¾—æ˜¯å¤šä½™ï¼Œæœ‰äººè§‰å¾—å¾ˆå¥½ç”¨ï¼Œæå¤§çš„å¢å¼ºäº†å®‰å…¨æ€§ã€‚å¦‚æœä½ å±äºè§‰å¾—è¿™ä¸ªåŠŸèƒ½å¤šä½™çš„ï¼Œå¯ä»¥ <code>deno run -A xxx</code> å³å¯ã€‚</p>
<h3 id="4-å…¼å®¹æµè§ˆå™¨-API"><a href="#4-å…¼å®¹æµè§ˆå™¨-API" class="headerlink" title="4.å…¼å®¹æµè§ˆå™¨ API"></a>4.å…¼å®¹æµè§ˆå™¨ API</h3><p>å¾ˆå¤šäººä¸ç†è§£ï¼Œä¸ºä»€ä¹ˆä½ ä¸€ä¸ªæœåŠ¡ç«¯è¯­è¨€è¦å…¼å®¹æµè§ˆå™¨ APIï¼Œä»¥åŠæ€ä¹ˆå…¼å®¹ã€‚</p>
<h4 id="ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨-API"><a href="#ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨-API" class="headerlink" title="ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨ API"></a>ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨ API</h4><p>å…³äºä¸ºä»€ä¹ˆï¼Œæˆ‘ä¸¾ä¸ªæ —å­å¤§å®¶å°±æ˜ç™½äº†ï¼šåœ¨è®¾è®¡ node ä¹‹å¤„ï¼Œå…³äºè¾“å‡ºå‡½æ•°æœ¬æ¥å« <code>print</code> ä¹‹ç±»çš„ï¼Œåæ¥æœ‰äººæè®®ä¸ºä»€ä¹ˆä¸å« <code>console.log</code>ï¼Œry è§‰å¾—æŒºä¸é”™ï¼Œäºæ˜¯å°±æ¥çº³äº†æ„è§ã€‚</p>
<p>ä½†æ˜¯ï¼Œè¿™ä¸ªè®¾è®¡å¹¶ä¸æ˜¯åˆ»æ„ä¸ºä¹‹ï¼Œè€Œ deno çš„è®¾è®¡åˆ™å¯ä»¥ä¸ºä¹‹ï¼Œé€šè¿‡ä¸æµè§ˆå™¨ API ä¿æŒä¸€è‡´ï¼Œæ¥<strong>å‡å°‘å¤§å®¶çš„è®¤çŸ¥</strong>ã€‚</p>
<h4 id="æ€ä¹ˆå…¼å®¹æµè§ˆå™¨-API"><a href="#æ€ä¹ˆå…¼å®¹æµè§ˆå™¨-API" class="headerlink" title="æ€ä¹ˆå…¼å®¹æµè§ˆå™¨ API"></a>æ€ä¹ˆå…¼å®¹æµè§ˆå™¨ API</h4><h5 id="æ¦‚å¿µä¸Šå…¼å®¹"><a href="#æ¦‚å¿µä¸Šå…¼å®¹" class="headerlink" title="æ¦‚å¿µä¸Šå…¼å®¹"></a>æ¦‚å¿µä¸Šå…¼å®¹</h5><ul>
<li>æ¨¡å—ç³»ç»Ÿï¼Œä»ä¸Šé¢ä»‹ç»çœ‹å‡º deno æ˜¯å®Œå…¨éµå¾ªæµè§ˆå™¨å®ç°çš„ï¼›</li>
<li>é»˜è®¤å®‰å…¨ï¼Œå½“ç„¶ä¹Ÿä¸æ˜¯è‡ªå·±åˆ›é€ çš„æ¦‚å¿µï¼Œw3c æ—©å·²åšå‡º<a href="https://w3c.github.io/permissions/#permission-registry" target="_blank" rel="noopener">æµè§ˆå™¨æƒé™</a>çš„è§„å®šï¼Œæˆ‘ä»¬åœ¨åšå°ç¨‹åºçš„æ—¶å€™å°¤ä¸ºæ˜æ˜¾ï¼Œéœ€è¦è·å–å„ç§æƒé™ï¼›</li>
<li>å¯¹äºå¼‚æ­¥æ“ä½œè¿”å› Promiseï¼›</li>
<li>ä½¿ç”¨ ArrayBuffer å¤„ç†äºŒè¿›åˆ¶ï¼›</li>
<li>ç­‰ç­‰â€¦</li>
</ul>
<h5 id="å­˜åœ¨-window-å…¨å±€å˜é‡"><a href="#å­˜åœ¨-window-å…¨å±€å˜é‡" class="headerlink" title="å­˜åœ¨ window å…¨å±€å˜é‡"></a>å­˜åœ¨ window å…¨å±€å˜é‡</h5><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="built_in">window</span> === <span class="keyword">this</span>, <span class="built_in">window</span> === self, <span class="built_in">window</span> === globalThis);</span><br></pre></td></tr></table></figure>
<h5 id="å®ç°äº†-WindowOrWorkerGlobalScope-çš„å…¨éƒ¨æ–¹æ³•"><a href="#å®ç°äº†-WindowOrWorkerGlobalScope-çš„å…¨éƒ¨æ–¹æ³•" class="headerlink" title="å®ç°äº† WindowOrWorkerGlobalScope çš„å…¨éƒ¨æ–¹æ³•"></a>å®ç°äº† <a href="[developer.mozilla.org/zh-CN/docs/â€¦](https://developer.mozilla.org/zh-CN/docs/Web/API/WindowOrWorkerGlobalScope">WindowOrWorkerGlobalScope</a> çš„å…¨éƒ¨æ–¹æ³•</h5><p>å…·ä½“æ–¹æ³•åˆ—è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥å‚è€ƒï¼š<a href="https://github.com/denoland/deno/blob/master/cli/js/lib.deno.shared_globals.d.ts" target="_blank" rel="noopener">lib.deno.shared_globals.d.ts</a> å’Œ <a href="https://github.com/denoland/deno/blob/master/cli/js/lib.deno.window.d.ts" target="_blank" rel="noopener">lib.deno.window.d.ts</a></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">fetch(<span class="string">"https://baidu.com"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// base64 è½¬åŒ–</span></span><br><span class="line"><span class="keyword">let</span> encodedData = btoa(<span class="string">"Hello, world"</span>); <span class="comment">// ç¼–ç </span></span><br><span class="line"><span class="keyword">let</span> decodedData = atob(encodedData); <span class="comment">// è§£ç </span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¾®ä»»åŠ¡</span></span><br><span class="line">queueMicrotask(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">123</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç­‰ç­‰...</span></span><br></pre></td></tr></table></figure>
<h5 id="å¤§è¶‹åŠ¿"><a href="#å¤§è¶‹åŠ¿" class="headerlink" title="å¤§è¶‹åŠ¿"></a>å¤§è¶‹åŠ¿</h5><p>æ€»ä½“è€Œè¨€ï¼Œå¦‚æœæœåŠ¡ç«¯å’Œæµè§ˆå™¨ç«¯å­˜åœ¨ç›¸åŒæ¦‚å¿µï¼Œdeno å°±ä¸ä¼šåˆ›é€ æ–°çš„æ¦‚å¿µã€‚è¿™ä¸€ç‚¹å…¶å® node ä¹Ÿåœ¨åšï¼Œæ–°çš„ <a href="https://github.com/nodejs/node/blob/master/doc/changelogs/CHANGELOG_V14.md" target="_blank" rel="noopener">node 14.0 CHANGELOG</a> å°±ä¹ŸæåŠè¦å®ç° <code>Universal JavaScript</code> å’Œ <code>Spec compliance and Web Compatibility</code>çš„æ€æƒ³ï¼Œæ‰€ä»¥è¿™ç‚¹å¤§å®¶åº”è¯¥éƒ½ä¼šæ¥å—å§ï¼Œæ¯•ç«Ÿå¤§åŠ¿æ‰€è¶‹è¶‹åŠ¿ã€‚</p>
<h3 id="5-æ”¯æŒ-typescript"><a href="#5-æ”¯æŒ-typescript" class="headerlink" title="5.æ”¯æŒ typescript"></a>5.æ”¯æŒ typescript</h3><p>ä¸ç®¡ä½ å–œæ¬¢ä¸å¦ï¼Œ2020 å¹´äº†ï¼Œå¿…é¡»å­¦ä¹  TS äº†ï¼ˆèµ·ç åœ¨é¢è¯•çš„æ—¶å€™æ˜¯äº®ç‚¹ï¼‰ã€‚å­¦å®Œä¹‹åä½ æ‰ä¼šæ˜ç™½<strong>çœŸé¦™å®šå¾‹</strong>çœŸçš„æ— å¤„ä¸åœ¨ã€‚</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.ts</span></span><br><span class="line"><span class="keyword">let</span> str: <span class="built_in">string</span> = <span class="string">"çœŸé¦™å®šå¾‹"</span>;</span><br><span class="line">str = <span class="number">132</span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run index.js</span><br><span class="line">error TS2322: Type '123' is not assignable to type 'string'.</span><br><span class="line"></span><br><span class="line">â–º file:///Users/Xiuming/Desktop/index.ts:2:1</span><br><span class="line"></span><br><span class="line">2 str = 123</span><br><span class="line">  ~~~</span><br></pre></td></tr></table></figure>
<h3 id="6-å»-node-modules"><a href="#6-å»-node-modules" class="headerlink" title="6.å» node_modules"></a>6.å» node_modules</h3><p>deno æ²¡æœ‰ node_modulesï¼Œé‚£ä¹ˆå®ƒæ˜¯æ€ä¹ˆè¿›è¡ŒåŒ…ç®¡ç†çš„å‘¢ï¼Ÿæˆ‘ä»¬å…ˆçœ‹ä¸‹é¢çš„ä¾‹å­</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.js</span></span><br><span class="line"><span class="keyword">import</span> &#123; white, bgRed &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std/fmt/colors.ts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(bgRed(white(<span class="string">"hello world!"</span>)));</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run index.js</span><br><span class="line">Download https://deno.land/std/fmt/colors.ts</span><br><span class="line">Compile https://deno.land/std/fmt/colors.ts</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹åˆ°å…¶æœ‰ <code>Download</code> å’Œ <code>Compile</code> ä¸¤ä¸ªæ­¥éª¤ï¼Œæˆ‘ä»¬ä¼šäº§ç”Ÿå‡ ä¸ªç–‘é—®ï¼š</p>
<p><strong>1ã€æ¯æ¬¡æ‰§è¡Œéƒ½è¦ä¸‹è½½å—ï¼Ÿ</strong> è§£ï¼šæˆ‘ä»¬åªéœ€è¦<strong>å†æ‰§è¡Œä¸€æ¬¡</strong>å°±èƒ½æ˜ç™½ï¼Œä¸éœ€è¦æ¯æ¬¡ä¸‹è½½ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run index.js</span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>
<p><strong>2ã€Download å’Œ Compile çš„æ–‡ä»¶åœ¨å“ªé‡Œå‘¢ï¼Ÿ</strong> è§£ï¼šæˆ‘ä»¬ä¼šå‘ç°ï¼Œå½“å‰æ‰§è¡Œçš„ç›®å½•ï¼Œå¹¶æ²¡æœ‰ Download å’Œ Compile æ–‡ä»¶ï¼Œé‚£æ–‡ä»¶æ”¾åœ¨å“ªé‡Œå‘¢ï¼Œæˆ‘ä»¬é¦–å…ˆæ¥çœ‹ä¸€ä¸‹ <code>deno --help</code> å‘½ä»¤ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno --help</span><br><span class="line">SUBCOMMANDS:</span><br><span class="line"><span class="meta">#</span> ...</span><br><span class="line">info           Show info about cache or info related to source file</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span> ...</span><br><span class="line">ENVIRONMENT VARIABLES:</span><br><span class="line">    DENO_DIR   Set deno's base directory (defaults to $HOME/.deno)</span><br></pre></td></tr></table></figure>
<p><code>deno info</code> å‘½ä»¤å±•ç¤ºäº†ä¾èµ–å…³ç³»ï¼Œç±»ä¼¼ <code>package.json</code>ã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno info index.js</span><br><span class="line">local: /Users/Xiuming/Desktop/index.js</span><br><span class="line">type: JavaScript</span><br><span class="line">deps:</span><br><span class="line">file:///Users/Xiuming/Desktop/index.js</span><br><span class="line">  â””â”€â”€ https://deno.land/std/fmt/colors.ts</span><br></pre></td></tr></table></figure>
<p><code>DENO_DIR</code> åˆ™ä¸ºå®é™…çš„å®‰è£…å’Œç¼–è¯‘ç›®å½•ï¼Œç›¸å½“äº <code>node_modules</code>ï¼Œé»˜è®¤ä¸º <code>$HOME/.deno</code>ï¼ˆå‘½ä»¤æç¤ºæ˜¯è¿™æ ·çš„ï¼Œä½†å®é™…éœ€è¦æŒ‡å®šä¸€ä¸‹ç¯å¢ƒå˜é‡ <code>export DENO_DIR=$HOME/.deno</code>ï¼‰ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> tree $HOME/.deno</span><br><span class="line">/Users/Xiuming/.deno</span><br><span class="line">â”œâ”€â”€ deps</span><br><span class="line">â”‚Â Â  â””â”€â”€ https</span><br><span class="line">â”‚Â Â      â””â”€â”€ deno.land</span><br><span class="line">â”‚Â Â          â”œâ”€â”€ 3574883d8acbaf00e28990ec8e83d71084c4c668c1dc7794be25208c60cfc935</span><br><span class="line">â”‚Â Â          â””â”€â”€ 3574883d8acbaf00e28990ec8e83d71084c4c668c1dc7794be25208c60cfc935.metadata.json</span><br><span class="line">â””â”€â”€ gen</span><br><span class="line">    â””â”€â”€ https</span><br><span class="line">        â””â”€â”€ deno.land</span><br><span class="line">            â””â”€â”€ std</span><br><span class="line">                â””â”€â”€ fmt</span><br><span class="line">                    â”œâ”€â”€ colors.ts.js</span><br><span class="line">                    â”œâ”€â”€ colors.ts.js.map</span><br><span class="line">                    â””â”€â”€ colors.ts.meta</span><br><span class="line"></span><br><span class="line">8 directories, 5 files</span><br></pre></td></tr></table></figure>
<p><strong>3ã€æ²¡ç½‘ç»œäº†æ€ä¹ˆåŠï¼Ÿ</strong></p>
<p>æˆ‘ä»¬æœ‰äº›åœºæ™¯æ˜¯å°†æœ¬åœ°å†™å¥½çš„ä»£ç éƒ¨ç½²åˆ°æ²¡æœ‰ç½‘ç»œçš„æœåŠ¡å™¨ï¼Œé‚£ä¹ˆå½“æ‰§è¡Œ <code>deno run xxx</code> æ—¶ï¼Œå°±æ˜¯æç¤º error sending requestã€‚</p>
<p><code>è§£ï¼š</code>å°†ä¸Šé¢çš„ç¼“å­˜ç›®å½•å†…å®¹ï¼Œç›´æ¥<strong>æ‹·è´åˆ°æœåŠ¡å™¨</strong>å¹¶æŒ‡å®šç¯å¢ƒå˜é‡åˆ°å…¶ç›®å½•å³å¯ã€‚</p>
<p><strong>4ã€ä¾èµ–ä»£ç æ›´æ–°äº†æ€ä¹ˆåŠï¼Ÿ</strong></p>
<p><code>è§£ï¼š</code>å½“ä¾èµ–æ¨¡å—æ›´æ–°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>--reload</code> è¿›è¡Œæ›´æ–°ç¼“å­˜ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --reload index.js</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡<strong>ç™½åå•</strong>çš„æ–¹å¼ï¼Œåªæ›´æ–°éƒ¨åˆ†ä¾èµ–ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> deno run --reload=https://deno.land index.js</span><br></pre></td></tr></table></figure>
<p><strong>5ã€ä»…ç¼“å­˜ä¾èµ–ï¼Œä¸æ‰§è¡Œä»£ç æœ‰åŠæ³•å—ï¼Ÿ</strong></p>
<p><code>è§£ï¼š</code>æœ‰çš„ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>deno cache index.js</code> è¿›è¡Œä¾èµ–ç¼“å­˜ã€‚</p>
<h3 id="7-æ ‡å‡†æ¨¡å—-ä¸-node-API-å…¼å®¹"><a href="#7-æ ‡å‡†æ¨¡å—-ä¸-node-API-å…¼å®¹" class="headerlink" title="7.æ ‡å‡†æ¨¡å— ä¸ node API å…¼å®¹"></a>7.æ ‡å‡†æ¨¡å— ä¸ node API å…¼å®¹</h3><p>æˆ‘ä»¬é€šè¿‡ç¬¬ 1 ç‚¹å¯ä»¥çœ‹åˆ°ï¼Œå…¶å® deno çš„ API ç›¸å¯¹äº node å…¶å®æ˜¯å°‘ä¸€äº›çš„ï¼Œé€šè¿‡å…¶æ–‡ä»¶å¤§å°ä¹Ÿèƒ½çœ‹å‡ºæ¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;</span> ll /usr/local/bin/node /Users/Xiuming/.local/bin/deno</span><br><span class="line">-rwxr-xr-x  1   42M   /Users/Xiuming/.local/bin/deno</span><br><span class="line">-rwxr-xr-x  1   70M   /usr/local/bin/node</span><br></pre></td></tr></table></figure>
<p>é‚£è¿™äº›å°‘çš„ API åªèƒ½è‡ªå·±å†™æˆ–è€…æ±‚åŠ©äºç¤¾åŒºå—ï¼Ÿ</p>
<p>deno å¯¹äºè‡ªèº«ç›¸å¯¹äº node å°‘çš„å’Œç¤¾åŒºä¸­å¸¸ç”¨çš„åŠŸèƒ½ï¼Œæä¾›äº†<a href="https://deno.land/std/" target="_blank" rel="noopener">æ ‡å‡†æ¨¡å—</a>ï¼Œå…¶ç‰¹ç‚¹æ˜¯ä¸ä¾èµ–éæ ‡å‡†æ¨¡å—çš„å†…å®¹ï¼Œè¾¾åˆ°ç¤¾åŒºå†…çš„æ¨¡å—å¼•ç”¨æœ€åéƒ½æ”¶æ•›äºæ ‡å‡†æ¨¡å—çš„æ•ˆæœã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ç±»ä¼¼ node ä¸­ chalk åŒ…</span></span><br><span class="line"><span class="keyword">import</span> &#123; bgRed, white &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std/fmt/colors.ts"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç±»ä¼¼ node ä¸­çš„ uuid åŒ…</span></span><br><span class="line"><span class="keyword">import</span> &#123; v4 &#125; <span class="keyword">from</span> <span class="string">"https://deno.land/std/uuid/mod.ts"</span>;</span><br></pre></td></tr></table></figure>
<p>åŒæ—¶ä¸ºäº†å¯¹ node ç”¨æˆ·å‹å¥½ï¼Œæä¾›äº† node API çš„å…¼å®¹</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> path <span class="keyword">from</span> <span class="string">"https://deno.land/std/node/path.ts"</span>;</span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> fs <span class="keyword">from</span> <span class="string">"https://deno.land/std/node/fs.ts"</span>;</span><br></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œå¤§å®¶åœ¨ä¸º deno ç¤¾åŒºåšè´¡çŒ®çš„æ—¶å€™ï¼Œé¦–å…ˆè¦çœ‹ä¸€ä¸‹æ ‡å‡†æ¨¡å—æœ‰æ²¡æœ‰æä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œå¦‚æœå·²ç»æä¾›äº†å¯ä»¥è¿›è¡Œå¼•ç”¨ã€‚</p>
<h3 id="8-å¼‚æ­¥æ“ä½œ"><a href="#8-å¼‚æ­¥æ“ä½œ" class="headerlink" title="8.å¼‚æ­¥æ“ä½œ"></a>8.å¼‚æ­¥æ“ä½œ</h3><blockquote>
<p>æ ¹æ® ry è‡ªå·±æ˜¯è¯´æ³•ï¼Œåœ¨è®¾è®¡ node æ˜¯æœ‰äººæè®® Promise å¤„ç†å›è°ƒï¼Œä½†æ˜¯ä»–æ²¡å¬ï¼Œç”¨ä»–è‡ªå·±çš„è¯è¯´å°±æ˜¯æ„šè ¢çš„æ‹’ç»äº†</p>
</blockquote>
<p>node ç”¨å›è°ƒçš„æ–¹å¼å¤„ç†å¼‚æ­¥æ“ä½œã€deno åˆ™é€‰æ‹©ç”¨ Promise</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node æ–¹å¼</span></span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line">fs.readFile(<span class="string">"./data.txt"</span>, (err, data) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (err) <span class="keyword">throw</span> err;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>å¦å¤– deno æ”¯æŒ top-level-awaitï¼Œæ‰€ä»¥ä»¥ä¸Šè¯»å–æ–‡ä»¶çš„ä»£ç å¯ä»¥ä¸ºï¼š</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// deno æ–¹å¼</span></span><br><span class="line"><span class="keyword">const</span> data = <span class="keyword">await</span> Deno.readFile(<span class="string">"./data.txt"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br></pre></td></tr></table></figure>
<p>node å…³äºè¿™æ–¹é¢ä¹Ÿåœ¨ä¸€ç›´æ”¹è¿›ï¼Œä¾‹å¦‚ç¤¾åŒºä¸Šå¾ˆå¤š <code>promisify</code> è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡åŒ…è£¹ä¸€å±‚å‡½æ•°ï¼Œå®ç°ç›®çš„ã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// node API promisify</span></span><br><span class="line"><span class="keyword">const</span> &#123; promisify &#125; = <span class="built_in">require</span>(<span class="string">"es6-promisify"</span>);</span><br><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> readFile = promisify(fs.readFile);</span><br><span class="line">  <span class="keyword">const</span> data = <span class="keyword">await</span> readFile(<span class="string">"./data.txt"</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main();</span><br></pre></td></tr></table></figure>
<h3 id="9-å•æ–‡ä»¶åˆ†å‘"><a href="#9-å•æ–‡ä»¶åˆ†å‘" class="headerlink" title="9.å•æ–‡ä»¶åˆ†å‘"></a>9.å•æ–‡ä»¶åˆ†å‘</h3><p>æˆ‘ä»¬çŸ¥é“ npm åŒ…å¿…é¡»æœ‰ <code>package.json</code> æ–‡ä»¶ï¼Œé‡Œé¢ä¸ä»…éœ€è¦æŒ‡æ˜ <code>main</code> æˆ– <code>module</code> æˆ– <code>browser</code> ç­‰å­—æ®µæ¥æ ‡æ˜å…¥å£æ–‡ä»¶ï¼Œè¿˜éœ€è¦æŒ‡æ˜ <code>name</code> ã€<code>license</code> ã€<code>description</code> ç­‰å­—æ®µæ¥è¯´æ˜è¿™ä¸ªåŒ…ã€‚</p>
<p>ry è§‰å¾—è¿™äº›å­—æ®µæ‰°ä¹±äº†å¼€å‘è€…çš„è§†å¬ï¼Œæ‰€ä»¥åœ¨ deno ä¸­ï¼Œå…¶æ¨¡å—ä¸éœ€è¦ä»»ä½•é…ç½®æ–‡ä»¶ï¼Œç›´æ¥æ˜¯ import url çš„å½¢å¼ã€‚</p>
<h3 id="10-å»ä¸­å¿ƒåŒ–ä»“åº“"><a href="#10-å»ä¸­å¿ƒåŒ–ä»“åº“" class="headerlink" title="10.å»ä¸­å¿ƒåŒ–ä»“åº“"></a>10.å»ä¸­å¿ƒåŒ–ä»“åº“</h3><p>å¯¹äº <a href="http://www.npmjs.com" target="_blank" rel="noopener">www.npmjs.com</a> æˆ‘ä»¬è‚¯å®šéƒ½ä¸é™Œç”Ÿï¼Œå®ƒæ˜¯æ¨åŠ¨ node è“¬å‹ƒå‘å±•çš„é‡è¦æ”¯ç‚¹ã€‚ä½†ä½œè€…è®¤ä¸ºå®ƒæ˜¯ä¸­å¿ƒåŒ–ä»“åº“ï¼Œè¿èƒŒäº†äº’è”ç½‘å»ä¸­å¿ƒåŒ–åŸåˆ™ã€‚</p>
<p>æ‰€ä»¥ deno å¹¶æ²¡æœ‰ä¸€ä¸ªåƒ npmjs.com çš„ä»“åº“ï¼Œé€šè¿‡<code>import url</code>çš„æ–¹å¼å°†äº’è”ç½‘ä»»ä½•ä¸€å¤„çš„ä»£ç éƒ½å¯ä»¥å¼•ç”¨ã€‚</p>
<h3 id="11-å»å¼€å‘ä¾èµ–"><a href="#11-å»å¼€å‘ä¾èµ–" class="headerlink" title="11.å»å¼€å‘ä¾èµ–"></a>11.å»å¼€å‘ä¾èµ–</h3><p>æˆ‘ä»¬åœ¨å†™ä¸€ä¸ª node åº“æˆ–è€…å·¥å…·æ—¶ï¼Œå¼€å‘ä¾èµ–æ˜¯å°‘ä¸äº†çš„ï¼Œä¾‹å¦‚ babel åšè½¬åŒ–å’Œæ‰“åŒ…ã€jest åšæµ‹è¯•ã€prettier åšä»£ç æ ¼å¼åŒ–ã€eslint åšä»£ç æ ¼å¼æ ¡æ£€ã€gulp æˆ–è€… webpack åšæ„å»ºç­‰ç­‰ï¼Œè®©æˆ‘ä»¬åœ¨å¼€å‘å‰å°±æå¾—ç­‹ç–²åŠ›å°½ã€‚</p>
<p>deno é€šè¿‡å†…ç½®äº†ä¸€äº›å·¥å…·ï¼Œè§£å†³ä¸Šè¿°é—®é¢˜ã€‚</p>
<ul>
<li><code>deno bundle</code>ï¼šæ‰“åŒ…å‘½ä»¤ï¼Œç”¨æ¥æ›¿æ¢ <code>babel</code>ã€<code>gulp</code> ä¸€ç±»å·¥å…·: ä¾‹å¦‚ï¼š<code>deno bundle ./mod.ts</code>ï¼›</li>
<li><code>deno fmt</code>ï¼šæ ¼å¼åŒ–å‘½ä»¤ï¼Œç”¨æ¥æ›¿æ¢ <code>prettier</code> ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ï¼š<code>deno fmt ./mod.ts</code>ï¼›</li>
<li><code>deno test</code>ï¼šè¿è¡Œæµ‹è¯•ä»£ç ï¼Œç”¨æ¥æ›¿æ¢ <code>jest</code> ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ <code>deno test ./test.ts</code>ï¼›</li>
<li><code>deno lint</code>ï¼šä»£ç æ ¡æ£€ï¼ˆæš‚æœªå®ç°ï¼‰ï¼Œç”¨æ¥æ›¿æ¢ <code>eslint</code> ä¸€ç±»å·¥å…·ï¼Œä¾‹å¦‚ï¼š<code>deno lint ./mod.ts</code>ã€‚</li>
</ul>
<blockquote>
<p>ä½œè€…ï¼šdream2023<br>é“¾æ¥ï¼š<a href="https://juejin.im/post/5ebcad19f265da7bb07656c7" target="_blank" rel="noopener">https://juejin.im/post/5ebcad19f265da7bb07656c7</a><br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p>
</blockquote>

      
    </div>

    

    
    
    

    
      <div>
        <div id="wechat_subscriber" style="display: block; padding: 10px 0; margin: 20px auto; width: 100%; text-align: center">
    <img id="wechat_subscriber_qcode" src="/images/wechat-qcode.jpg" alt="Xiuming Lee wechat" style="width: 200px; max-width: 100%;">
    <div>æ¬¢è¿æ‚¨æ‰«ä¸€æ‰«ä¸Šé¢çš„å¾®ä¿¡å…¬ä¼—å·è®¢é˜…ï¼Œæ›´å¤šæƒŠå–œç­‰ç€æ‚¨å“¦ï¼</div>
</div>

      </div>
    

    
       
    
    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>æ‰“èµ</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="Xiuming Lee å¾®ä¿¡æ”¯ä»˜">
        <p>å¾®ä¿¡æ”¯ä»˜</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="Xiuming Lee æ”¯ä»˜å®">
        <p>æ”¯ä»˜å®</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    
    
    <div>
     
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------æœ¬æ–‡ç»“æŸ<i class="fa fa-hourglass-end"></i>æ„Ÿè°¢æ‚¨çš„é˜…è¯»-------------</div>
    
</div>
    
    </div>
    


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/è½¬è½½/" rel="tag"><i class="fa fa-tag"></i> è½¬è½½</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/Java/Python/æŠ“å–Bilibiliå“”å“©å“”å“©ç½‘ç«™è§†é¢‘-Javaå’ŒPythonåŒç‰ˆæœ¬å®ç°.html" rel="next" title="æŠ“å–Bilibiliå“”å“©å“”å“©ç½‘ç«™è§†é¢‘(Javaå’ŒPythonåŒç‰ˆæœ¬å®ç°)">
                <i class="fa fa-chevron-left"></i> æŠ“å–Bilibiliå“”å“©å“”å“©ç½‘ç«™è§†é¢‘(Javaå’ŒPythonåŒç‰ˆæœ¬å®ç°)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/è½¬è½½/Denoæé€Ÿå…¥é—¨.html" rel="prev" title="Denoæé€Ÿå…¥é—¨">
                Denoæé€Ÿå…¥é—¨ <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            æ–‡ç« ç›®å½•
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            ç«™ç‚¹æ¦‚è§ˆ
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="http://qiniu.mrain22.cn/image/touxiang/201811291022.jpg" alt="Xiuming Lee">
            
              <p class="site-author-name" itemprop="name">Xiuming Lee</p>
              <p class="site-description motion-element" itemprop="description">Think Twice Code Oncecd</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">24</span>
                    <span class="site-state-item-name">æ—¥å¿—</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">9</span>
                    <span class="site-state-item-name">åˆ†ç±»</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">14</span>
                    <span class="site-state-item-name">æ ‡ç­¾</span>
                  </a>
                </div>
              
            </nav>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/XiumingLee" title="GitHub &rarr; https://github.com/XiumingLee" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="mailto:lxmcoder@163.com" title="E-Mail &rarr; mailto:lxmcoder@163.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#å‰è¨€"><span class="nav-number">1.</span> <span class="nav-text">å‰è¨€</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Deno-VS-Node"><span class="nav-number">2.</span> <span class="nav-text">Deno VS Node</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-å†…ç½®-API-å¼•ç”¨æ–¹å¼ä¸åŒ"><span class="nav-number">2.1.</span> <span class="nav-text">1.å†…ç½® API å¼•ç”¨æ–¹å¼ä¸åŒ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#node-æ¨¡å—å¯¼å…¥"><span class="nav-number">2.1.1.</span> <span class="nav-text">node æ¨¡å—å¯¼å…¥</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#deno-å…¨å±€å¯¹è±¡"><span class="nav-number">2.1.2.</span> <span class="nav-text">deno å…¨å±€å¯¹è±¡</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-æ¨¡å—ç³»ç»Ÿ"><span class="nav-number">2.2.</span> <span class="nav-text">2.æ¨¡å—ç³»ç»Ÿ</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#node-CommonJS-è§„èŒƒ"><span class="nav-number">2.2.1.</span> <span class="nav-text">node CommonJS è§„èŒƒ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ES-Module-çš„æµè§ˆå™¨å®ç°"><span class="nav-number">2.2.2.</span> <span class="nav-text">ES Module çš„æµè§ˆå™¨å®ç°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#deno-çš„æ¨¡å—è§„èŒƒ"><span class="nav-number">2.2.3.</span> <span class="nav-text">deno çš„æ¨¡å—è§„èŒƒ</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-å®‰å…¨"><span class="nav-number">2.3.</span> <span class="nav-text">3.å®‰å…¨</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#æ¨¡æ‹Ÿç›—å·"><span class="nav-number">2.3.1.</span> <span class="nav-text">æ¨¡æ‹Ÿç›—å·</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#é»˜è®¤å®‰å…¨çš„-deno"><span class="nav-number">2.3.2.</span> <span class="nav-text">é»˜è®¤å®‰å…¨çš„ deno</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç™½åå•"><span class="nav-number">2.3.3.</span> <span class="nav-text">ç™½åå•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ç®€åŒ–å‚æ•°"><span class="nav-number">2.3.4.</span> <span class="nav-text">ç®€åŒ–å‚æ•°</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-å…¼å®¹æµè§ˆå™¨-API"><span class="nav-number">2.4.</span> <span class="nav-text">4.å…¼å®¹æµè§ˆå™¨ API</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨-API"><span class="nav-number">2.4.1.</span> <span class="nav-text">ä¸ºä»€ä¹ˆè¦å…¼å®¹æµè§ˆå™¨ API</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#æ€ä¹ˆå…¼å®¹æµè§ˆå™¨-API"><span class="nav-number">2.4.2.</span> <span class="nav-text">æ€ä¹ˆå…¼å®¹æµè§ˆå™¨ API</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#æ¦‚å¿µä¸Šå…¼å®¹"><span class="nav-number">2.4.2.1.</span> <span class="nav-text">æ¦‚å¿µä¸Šå…¼å®¹</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å­˜åœ¨-window-å…¨å±€å˜é‡"><span class="nav-number">2.4.2.2.</span> <span class="nav-text">å­˜åœ¨ window å…¨å±€å˜é‡</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å®ç°äº†-WindowOrWorkerGlobalScope-çš„å…¨éƒ¨æ–¹æ³•"><span class="nav-number">2.4.2.3.</span> <span class="nav-text">å®ç°äº† WindowOrWorkerGlobalScope çš„å…¨éƒ¨æ–¹æ³•</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#å¤§è¶‹åŠ¿"><span class="nav-number">2.4.2.4.</span> <span class="nav-text">å¤§è¶‹åŠ¿</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-æ”¯æŒ-typescript"><span class="nav-number">2.5.</span> <span class="nav-text">5.æ”¯æŒ typescript</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-å»-node-modules"><span class="nav-number">2.6.</span> <span class="nav-text">6.å» node_modules</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-æ ‡å‡†æ¨¡å—-ä¸-node-API-å…¼å®¹"><span class="nav-number">2.7.</span> <span class="nav-text">7.æ ‡å‡†æ¨¡å— ä¸ node API å…¼å®¹</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-å¼‚æ­¥æ“ä½œ"><span class="nav-number">2.8.</span> <span class="nav-text">8.å¼‚æ­¥æ“ä½œ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-å•æ–‡ä»¶åˆ†å‘"><span class="nav-number">2.9.</span> <span class="nav-text">9.å•æ–‡ä»¶åˆ†å‘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-å»ä¸­å¿ƒåŒ–ä»“åº“"><span class="nav-number">2.10.</span> <span class="nav-text">10.å»ä¸­å¿ƒåŒ–ä»“åº“</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#11-å»å¼€å‘ä¾èµ–"><span class="nav-number">2.11.</span> <span class="nav-text">11.å»å¼€å‘ä¾èµ–</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">  <a href="http://www.beian.miit.gov.cn" rel="noopener" target="_blank">é²ICPå¤‡18016938å· </a>&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Xiuming Lee</span>

  

  
</div>









        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv" title="æ€»è®¿å®¢é‡">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
    </span>
  

  
    <span class="site-pv" title="æ€»è®¿é—®é‡">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
    </span>
  
</div>









        
      </div>
    </footer>

    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.5.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=6.5.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=6.5.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.5.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.5.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.5.0"></script>



  



  










  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  

  

  
  

  

  

  

  

  

  

</body>
</html>
